/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our Samples at https://docs.gradle.org/9.0.0/samples
 */

allprojects {
    group = 'io.yamsergey.adt'
    version = '1.0.0'

    // Test fixtures directory - available to all subprojects
    ext {
        testFixturesDir = rootProject.file('test-fixtures')
    }
}

subprojects {
    apply plugin: 'java'
    
    java {
        sourceCompatibility = JavaVersion.VERSION_21
        targetCompatibility = JavaVersion.VERSION_21
    }
    
    repositories {
        mavenCentral()
    }
    
    dependencies {
        testImplementation platform(libs.junit.bom)
        testImplementation libs.junit.jupiter
    }
    
    test {
        useJUnitPlatform()
    }
}

tasks.register('cleanLsp') {
    group = 'cleanup'
    description = 'Removes .settings and .project files created by jdtls'

    def projectDirs = allprojects.collect { it.projectDir }

    doLast {
        projectDirs.each { dir ->
            def settingsDir = new File(dir, '.settings')
            def projectFile = new File(dir, '.project')

            if (settingsDir.exists()) {
                settingsDir.deleteDir()
                println "Deleted ${settingsDir}"
            }
            if (projectFile.exists()) {
                projectFile.delete()
                println "Deleted ${projectFile}"
            }
        }
    }
}
